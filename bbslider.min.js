!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.BBSlider=t()}(this,function(){return function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.BBSlider=e()}}(function(){return function e(t,r,n){function i(o,a){if(!r[o]){if(!t[o]){var u="function"==typeof require&&require;if(!a&&u)return u(o,!0);if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var h=r[o]={exports:{}};t[o][0].call(h.exports,function(e){var r=t[o][1][e];return i(r?r:e)},h,h.exports,e,t,r,n)}return r[o].exports}for(var s="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=e("./modules/bar"),a=n(o),u=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];i(this,e),this._bar=new a["default"](t),this.el=this._bar.el}return s(e,[{key:"_validateRangeValue",value:function(e){if(!Array.isArray(e)||2!=e.length)throw Error;return!0}},{key:"_validateValue",value:function(e){if(!Array.isArray(e))throw Error;var t=!0,r=!1,n=void 0;try{for(var i,s=e[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var o=i.value;this._validateRangeValue(o)}}catch(a){r=!0,n=a}finally{try{!t&&s["return"]&&s["return"]()}finally{if(r)throw n}}return!0}},{key:"addRange",value:function(e,t){if(t=Object.assign({id:void 0},t),this._validateRangeValue(e,t)){if(void 0!==t.id&&this._bar.rangeList.find(function(e){return e.id===t.id}))throw new Error("range with this id already exists");if(this._bar.isInsideRange(e[0])||this._bar.isInsideRange(e[1]))throw new Error("intersection");var r=!0,n=!1,i=void 0;try{for(var s,o=this._bar.rangeList[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var a=s.value;if(e[0]<=a.left&&a.right<=e[1])throw new Error("intersection")}}catch(u){n=!0,i=u}finally{try{!r&&o["return"]&&o["return"]()}finally{if(n)throw i}}this._bar.addRange(e,t)}}},{key:"removeRange",value:function(e){if("object"!=typeof e)throw new Error("wrong data");if(void 0===e.id)throw new Error("wrong data");return this._bar.removeRange(e)}},{key:"val",value:function(e,t){return void 0===e?this._bar.getValue():void(this._validateValue(e,t)&&this._bar.setValue(e,t))}},{key:"on",value:function(e,t){this._bar.emitter.addListener(e,t)}},{key:"off",value:function(e,t){this._bar.emitter.removeListener(e,t)}}]),e}();r["default"]=u,t.exports=r["default"]},{"./modules/bar":2}],2:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(e,t,r){for(var n=!0;n;){var i=e,s=t,o=r;n=!1,null===i&&(i=Function.prototype);var a=Object.getOwnPropertyDescriptor(i,s);if(void 0!==a){if("value"in a)return a.value;var u=a.get;return void 0===u?void 0:u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return void 0;e=l,t=s,r=o,n=!0,a=l=void 0}},u=e("./ghost"),l=n(u),h=e("./range"),f=n(h),d=e("./base"),c=n(d),v=e("./emitter"),p=n(v),g=function(e){function t(){var e=this,r=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];i(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.options=Object.assign({allowRemove:!1},r),this.el=document.createElement("div"),this.el.className="bbslider-bar",this.el.addEventListener("mousemove",function(t){return e.mousemove(t)}),this.el.addEventListener("mouseleave",function(t){return e.mouseleave(t)}),this.el.addEventListener("mouseup",function(t){return e.mouseup(t)}),this.el.addEventListener("mousedown",function(t){return e.mousedown(t)}),this.rangeIdCount=0,this.rangeList=[],this.emitter=new p["default"]}return s(t,e),o(t,[{key:"getRangeId",value:function(){return this.rangeIdCount+=1,this.rangeIdCount}},{key:"addRange",value:function(e,t){var r=this;t=Object.assign({id:this.getRangeId()},t),t.bar=this;var n=new f["default"](t);this.el.appendChild(n.el),n.setValue(e[0],e[1]),this.rangeList.push(n),this.removeGhost(),n.emitter.addListener("range:changing",function(e){r.emitter.emit("changing",{rangeId:n.id,val:r.getValue()}),r.emitter.emit("range:changing",e)}),n.emitter.addListener("range:change",function(e){r.emitter.emit("change",{rangeId:n.id,val:r.getValue()}),r.emitter.emit("range:change",e)})}},{key:"removeRange",value:function(e){var t=this.rangeList.find(function(t){return t.id==e.id});return t?(this.el.removeChild(t.el),this.rangeList=this.rangeList.filter(function(t){return t.id!==e.id}),!0):!1}},{key:"removeGhost",value:function(){this.ghost&&(this.el.removeChild(this.ghost.el),delete this.ghost)}},{key:"mousedown",value:function(){}},{key:"mouseup",value:function(){this.ghost&&this.addRange([this.ghost.left,this.ghost.right])}},{key:"mouseleave",value:function(){this.removeGhost()}},{key:"isInsideRange",value:function(e){var t=!0,r=!1,n=void 0;try{for(var i,s=this.rangeList[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var o=i.value;if(o.left<e&&e<o.right)return!0}}catch(a){r=!0,n=a}finally{try{!t&&s["return"]&&s["return"]()}finally{if(r)throw n}}return!1}},{key:"mousemove",value:function(e){var t=this.getCursor(e),r=this.isInsideRange(t),n=this.rangeList.filter(function(e){return e.pressed}).length>0;if(!n&&!r&&!this.ghost){this.ghost=new l["default"]({bar:this}),this.el.appendChild(this.ghost.el);var i=this.roundUserValue(t);this.ghost.setValue(i,i+this.options.step)}}},{key:"setValue",value:function(e){var t=!0,r=!1,n=void 0;try{for(var i,s=e[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var o=i.value;this.addRange(o)}}catch(a){r=!0,n=a}finally{try{!t&&s["return"]&&s["return"]()}finally{if(r)throw n}}}},{key:"getValue",value:function(){var e=[],t=!0,r=!1,n=void 0;try{for(var i,s=this.rangeList[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var o=i.value,a=o.getValue();e.push(a)}}catch(u){r=!0,n=u}finally{try{!t&&s["return"]&&s["return"]()}finally{if(r)throw n}}return e}}]),t}(c["default"]);r["default"]=g,t.exports=r["default"]},{"./base":3,"./emitter":4,"./ghost":5,"./range":6}],3:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function(){function e(){n(this,e)}return i(e,[{key:"pixelToUnit",value:function(e){var t=this.el.getBoundingClientRect(),r=t.width;if(0==r)throw new Error("element width is 0 or element is not attached to dom");return e/r}},{key:"unitToPixel",value:function(e){var t=this.el.getBoundingClientRect(),r=t.width;return e*r}},{key:"unitToUser",value:function(e){return(this.options.max-this.options.min)*e+this.options.min}},{key:"userToUnit",value:function(e){return(e-this.options.min)/(this.options.max-this.options.min)}},{key:"roundUserValue",value:function(e){return this.options.min+Math.floor((e-this.options.min)/this.options.step)*this.options.step}},{key:"getCursor",value:function(e){var t=this.el.getBoundingClientRect(),r=e.clientX-t.left;return this.unitToUser(this.pixelToUnit(r))}}]),e}();r["default"]=s,t.exports=r["default"]},{}],4:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function(e){return"function"==typeof e||!1},o=function(){function e(){n(this,e),this.listeners=new Map}return i(e,[{key:"addListener",value:function(e,t){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(t)}},{key:"removeListener",value:function(e,t){var r=this.listeners.get(e),n=void 0;return r&&r.length&&(n=r.reduce(function(e,r,n){return s(r)&&r===t?e=n:e},-1),n>-1)?(r.splice(n,1),this.listeners.set(e,r),!0):!1}},{key:"emit",value:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;t>n;n++)r[n-1]=arguments[n];var i=this.listeners.get(e);return i&&i.length?(i.forEach(function(e){e.apply(void 0,r)}),!0):!1}}]),e}();r["default"]=o,t.exports=r["default"]},{}],5:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=e("./emitter"),a=(n(o),function(){function e(t){var r=this;i(this,e),this.bar=t.bar,this.el=document.createElement("div"),this.el.className="bbslider-ghost",this.pressed=!1,this.bar.el.addEventListener("mousemove",function(e){return r.mousemove(e)}),this.bar.el.addEventListener("mousedown",function(e){return r.mousedown(e)}),this.bar.el.addEventListener("mouseup",function(e){return r.mouseup(e)})}return s(e,[{key:"mousedown",value:function(e){this.el==e.target&&(this.pressed=!0)}},{key:"mouseup",value:function(){this.pressed=!1}},{key:"mousemove",value:function(e){var t=this.bar.getCursor(e);this.bar.isInsideRange(t)&&!this.pressed&&this.bar.removeGhost(),t=this.bar.roundUserValue(t);var r=this.left,n=this.right;this.pressed?r>=t?r=t:n=t+this.bar.options.step:(r=t,n=t+this.bar.options.step),this.bar.options.max<n&&(n=this.bar.options.max,n-r<this.bar.options.step&&(r=this.bar.options.max-this.bar.options.step)),this.bar.options.min>r&&(r=this.bar.options.min,n-r<this.bar.options.step&&(n=this.bar.options.min+this.bar.options.step)),this.bar.isInsideRange(r)||this.bar.isInsideRange(n)?this.pressed||this.bar.removeGhost():this.setValue(r,n)}},{key:"setValue",value:function(e,t){this.left=e,this.right=t;var r=100*this.bar.userToUnit(e),n=100*this.bar.userToUnit(t);this.el.style.left=r+"%",this.el.style.width=n-r+"%"}}]),e}());r["default"]=a,t.exports=r["default"]},{"./emitter":4}],6:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=e("./utils"),a=e("./emitter"),u=n(a),l=function(){function e(t){var r=this;i(this,e),this.bar=t.bar,this.id=t.id,this.el=document.createElement("div"),this.el.className="bbslider-range",this.right_handler=document.createElement("div"),this.right_handler.className="bbslider-right-handler",this.el.appendChild(this.right_handler),this.left_handler=document.createElement("div"),this.left_handler.className="bbslider-left-handler",this.el.appendChild(this.left_handler),this.pressed=!1,this.bar.el.addEventListener("mousemove",function(e){return r.mousemove(e)}),this.bar.el.addEventListener("mousedown",function(e){return r.mousedown(e)}),this.bar.el.addEventListener("mouseup",function(e){return r.mouseup(e)}),this.emitter=new u["default"]}return s(e,[{key:"mousedown",value:function(e){e.target==this.el&&(this.pressed=!0,this.pressedMode="this"),e.target==this.right_handler&&(this.pressed=!0,this.pressedMode="right"),e.target==this.left_handler&&(this.pressed=!0,this.pressedMode="left"),this.pressed&&(o.addClass(this.el,"pressed"),this.pressedPosition=this.bar.roundUserValue(this.bar.getCursor(e)))}},{key:"mousemove",value:function(e){if(this.pressed){var t=this.bar.getCursor(e),r=t-this.pressedPosition,n=this.bar.roundUserValue(r);if(0==n)return;var i=this.right,s=this.left;if("this"==this.pressedMode&&(i+=n,s+=n),"right"==this.pressedMode&&(i+=n),"left"==this.pressedMode&&(s+=n),s>i)return;if(s<this.bar.options.min)return;if(i>this.bar.options.max)return;var o=!1,a=!0,u=!1,l=void 0;try{for(var h,f=this.bar.rangeList[Symbol.iterator]();!(a=(h=f.next()).done);a=!0){var d=h.value;if(o)break;d!=this&&(d.left<i&&i<=d.right&&(o=!0),d.left<=s&&s<d.right&&(o=!0),s<=d.left&&d.right<=i&&(o=!0))}}catch(c){u=!0,l=c}finally{try{!a&&f["return"]&&f["return"]()}finally{if(u)throw l}}if(o)return;this.pressedPosition+=n,this.setValue(s,i),this.emitter.emit("range:changing",{id:this.id,val:this.getValue()})}}},{key:"mouseup",value:function(e){-1!==[this.el,this.left_handler,this.right_handler].indexOf(e.target)&&(this.pressed=!1,this.pressedPosition=void 0,o.removeClass(this.el,"pressed"),this.emitter.emit("range:change",{id:this.id,val:this.getValue()}))}},{key:"setValue",value:function(e,t){this.left=e,this.right=t;var r=100*this.bar.userToUnit(e),n=100*this.bar.userToUnit(t);this.el.style.left=r+"%",this.el.style.width=n-r+"%"}},{key:"getValue",value:function(){return[this.left,this.right]}}]),e}();r["default"]=l,t.exports=r["default"]},{"./emitter":4,"./utils":7}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(e,t){return new RegExp(" "+t+" ").test(" "+e.className+" ")},i=function(e,t){n(e,t)||(e.className+=" "+t)},s=function(e,t){var r=" "+e.className.replace(/[\t\r\n]/g," ")+" ";if(n(e,t)){for(;r.indexOf(" "+t+" ")>=0;)r=r.replace(" "+t+" "," ");e.className=r.replace(/^\s+|\s+$/g,"")}};r.hasClass=n,r.addClass=i,r.removeClass=s},{}]},{},[1])(1)}),BBSlider});